@echo off
chcp 65001 >nul
cd /d "%~dp0"

echo ============================================================
echo üöÄ –ê–ù–ê–õ–ò–ó–ê–¢–û–† –¢–û–†–ì–û–í–´–• –°–î–ï–õ–û–ö
echo ============================================================
echo.

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Python
python --version >nul 2>&1
if errorlevel 1 (
    echo ‚ùå Python –Ω–µ –Ω–∞–π–¥–µ–Ω! –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞.
    pause
    exit /b 1
) else (
    for /f "tokens=*" %%i in ('python --version 2^>^&1') do set PYTHON_VERSION=%%i
    echo ‚úÖ Python –Ω–∞–π–¥–µ–Ω: !PYTHON_VERSION!
)

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
if not exist "trades_analyzer.py" (
    echo ‚ùå –§–∞–π–ª trades_analyzer.py –Ω–µ –Ω–∞–π–¥–µ–Ω!
    pause
    exit /b 1
)

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø–∞–ø–∫–∏ input
if not exist "input" (
    echo üìÅ –°–æ–∑–¥–∞—é –ø–∞–ø–∫—É input...
    mkdir input
)

echo üîç –ó–∞–ø—É—Å–∫–∞—é –∞–Ω–∞–ª–∏–∑ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–¥–µ–ª–æ–∫...
echo.

REM –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
python trades_analyzer.py

if %errorlevel% equ 0 (
    echo.
    echo ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!
    echo üìä Excel —Ñ–∞–π–ª —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –æ—Ç–∫—Ä—ã—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    echo üìÇ –í—Å–µ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –ø–∞–ø–∫–µ input/
    echo üéØ –ê–∫—Ç–∏–≤–Ω—ã–π –ª–∏—Å—Ç: –°–µ—Å—Å–∏—è_–ø–æ_—Ç–∏–∫–µ—Ä–∞–º
) else (
    echo.
    echo ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∞–Ω–∞–ª–∏–∑–∞!
)

echo.
echo ============================================================
pause
